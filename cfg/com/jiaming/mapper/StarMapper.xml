<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jiaming.mapper.StarMapper">

	<update id="updateStarBySidForScount" >
		update  star  
		<set>
			scount =  scount+#{value}
		</set>
		<where>
			sid = #{sid}
		</where>	
	
	</update>

	
	<select id="selectStarByUidAndFid" resultType="com.jiaming.entity.Star">
		select * from star
		where
		uid = #{uid}
		and
		fid = #{fid}
	
	</select>



	<select id="selectStarFruitPovosByUid" resultMap="StarFruitPovo">
		
		select * from fruit,star
		where
		star.fid = fruit.f_id
		and uid = #{uid}
	
	</select>
	<resultMap type="com.jiaming.povos.StarFruitPovo" id="StarFruitPovo">
		<association property="star" javaType="com.jiaming.entity.Star">
			<id column="sid" property="sid" jdbcType="VARCHAR" />
			<result column="fid" property="fid" jdbcType="INTEGER" />
			<result column="uid" property="uid" jdbcType="VARCHAR" />
			<result column="scount" property="scount" jdbcType="INTEGER" />
		</association>
		<association property="fruit"
			javaType="com.jiaming.entity.Fruit">
			<id column="f_id" property="fId" jdbcType="INTEGER" />
			<result column="f_name" property="fName" jdbcType="VARCHAR" />
			<result column="f_norm" property="fNorm" jdbcType="VARCHAR" />
			<result column="f_price" property="fPrice" jdbcType="DECIMAL" />
			<result column="f_summary" property="fSummary"
				jdbcType="VARCHAR" />
			<result column="f_prompt" property="fPrompt"
				jdbcType="VARCHAR" />
			<result column="f_hot" property="fHot" jdbcType="TINYINT" />
			<result column="f_imgcount" property="fImgcount"
				jdbcType="INTEGER" />
			<result column="c_id" property="cId" jdbcType="VARCHAR" />

		</association>
		
	</resultMap>



	<resultMap id="BaseResultMap" type="com.jiaming.entity.Star">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Dec 02 
			16:01:14 CST 2019. -->
		<id column="sid" property="sid" jdbcType="VARCHAR" />
		<result column="fid" property="fid" jdbcType="INTEGER" />
		<result column="uid" property="uid" jdbcType="VARCHAR" />
		<result column="scount" property="scount" jdbcType="INTEGER" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Dec 02 
			16:01:14 CST 2019. -->
		delete from star
		where sid = #{sid,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.jiaming.entity.Star">
		<selectKey keyProperty="sid" resultType="string" order="BEFORE">
			select replace(uuid(),"-","") from dual;
		
		</selectKey>
		
		
		insert into star (sid, fid, uid,
		scount)
		values (#{sid,jdbcType=VARCHAR}, #{fid,jdbcType=INTEGER},
		#{uid,jdbcType=VARCHAR},
		#{scount,jdbcType=INTEGER})
	</insert>
	<update id="updateByPrimaryKey"
		parameterType="com.jiaming.entity.Star">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Dec 02 
			16:01:14 CST 2019. -->
		update star
		set fid = #{fid,jdbcType=INTEGER},
		uid = #{uid,jdbcType=VARCHAR},
		scount = #{scount,jdbcType=INTEGER}
		where sid = #{sid,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Dec 02 
			16:01:14 CST 2019. -->
		select sid, fid, uid, scount
		from star
		where sid = #{sid,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Dec 02 
			16:01:14 CST 2019. -->
		select sid, fid, uid, scount
		from star
	</select>
</mapper>